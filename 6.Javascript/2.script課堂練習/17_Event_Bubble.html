<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
    />
    <title>冒泡事件的原理</title>
    <style type="text/css">
      table {
        font-family: arial, sans-serif;
        border-collapse: collapse;
        width: 100%;
      }

      td,
      th {
        border: 4px solid #dddddd;
        text-align: left;
        padding: 8px;
      }
      body {
        background: lightgreen;
      }
      thead {
        background: purple;
      }
      td {
        background: lightblue;
      }
      p {
        background: pink;
      }
      a {
        background: yellow;
        color: blue;
      }
    </style>
  </head>
  <body>
    <h2>先捕獲，再冒泡</h2>
    <table>
      <thead>
        <tr>
          <th>表格標題</th>
          <th>表格標題</th>
          <th>表格標題</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>資料</td>
          <td>
            <p>這裡是td</p>
            <a id="clickMe" href="https://www.youtube.com/watch?v=wFqUAw_NYvs"
              >Click Me</a
            >
            <p>這裡是td</p>
          </td>
          <td>資料</td>
        </tr>
        <tr>
          <td>資料</td>
          <td>資料</td>
          <td>資料</td>
        </tr>
      </tbody>
    </table>

    <script type="text/javascript">
      // 1. 嘗試將e.stopPropagation() 加入到任何一個事件處理器裡，看看有何變化？

      // 2. 嘗試將e.preventDefault() 加入到任何一個事件處理器裡，看看有何變化？

      // 3. 將 table 的捕獲2 註解的那段打開，看看有何變化？

      console.log('====================================');
      console.log('事件的傳遞現象  - 先捕獲，再冒泡');

      function init() {
        // eventPhase: 1 是CAPTURING_PHASE，2 是AT_TARGET，3 是BUBBLING_PHASE
        // body 的捕獲
        document.getElementsByTagName('body')[0].addEventListener(
          'click',
          function (e) {
            console.log('body capturing', e.eventPhase);
            alert('body 捕獲');
          },
          true
        );

        // table 的捕獲
        document.getElementsByTagName('table')[0].addEventListener(
          'click',
          function (e) {
            console.log('table capturing', e.eventPhase);
            alert('table 捕獲');
            // e.stopPropagation();  // ***取消事件繼續往下傳遞
            // e.preventDefault(); // ***取消瀏覽器的預設行為, ex. 阻止超連結, form表單submit
          },
          true
        );

        // // table 的捕獲2
        // document.getElementsByTagName("table")[0].addEventListener('click', function(e) {
        //     console.log('table capturing2', e.eventPhase);
        //     alert('table 捕獲2');
        // }, true);

        // tr 的捕獲
        document.getElementsByTagName('tr')[0].addEventListener(
          'click',
          function (e) {
            console.log('tr capturing', e.eventPhase);
            alert('tr 捕獲');
          },
          true
        );

        // td 的捕獲
        document.getElementsByTagName('td')[1].addEventListener(
          'click',
          function (e) {
            console.log('td capturing', e.eventPhase);
            alert('td 捕獲');
          },
          true
        );

        // a 的捕獲
        document.getElementsByTagName('a')[0].addEventListener(
          'click',
          function (e) {
            console.log('a capturing', e.eventPhase);
            alert('a 捕獲');
          },
          true
        );

        // a 的冒泡
        document.getElementsByTagName('a')[0].addEventListener(
          'click',
          function (e) {
            console.log('a bubbling', e.eventPhase);
            alert('a 冒泡');
          },
          false
        );

        // td 的冒泡
        document.getElementsByTagName('td')[1].addEventListener(
          'click',
          function (e) {
            console.log('td bubbling', e.eventPhase);
            alert('td 冒泡');
          },
          false
        );

        // tr 的冒泡
        document.getElementsByTagName('tr')[0].addEventListener(
          'click',
          function (e) {
            console.log('tr bubbling', e.eventPhase);
            alert('tr 冒泡');
          },
          false
        );

        // table 的冒泡
        document.getElementsByTagName('table')[0].addEventListener(
          'click',
          function (e) {
            console.log('table bubbling', e.eventPhase);
            alert('table 冒泡');
          },
          false
        );

        // body 的冒泡
        document.getElementsByTagName('body')[0].addEventListener(
          'click',
          function (e) {
            console.log('body bubbling', e.eventPhase);
            alert('body 冒泡');
          },
          false
        );
      }
      window.addEventListener('load', init);

      console.log('====================================');
    </script>
  </body>
</html>
