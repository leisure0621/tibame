<!DOCTYPE html>
<html lang="">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
		<title>15_Form</title>
		<style type="text/css">
			table {
				border-collapse: collapse;
			}
			table td, table th {
			  border: 1px solid #ddd;
			  padding: 8px;
			}
		</style>

	</head>
	<body>
		<p>表單範例</p>
		<form id="myForm" name="myForm" action="http://www.google.com" method="GET">
			<table>
				<tr>
					<th>欄位</th>
					<th>資料</th>
				</tr>
				<tr>
					<td>姓名</td>
					<td>
						<input type="text" name="myName" value="Pikachu" required>
					</td>
				</tr>
				<tr>
					<td>身高(cm)</td>
					<td>
						<input type="number" name="height" value="200" required>
					</td>
				</tr>
				<tr>
					<td>體重(kg)</td>
					<td>
						<input type="number" name="weight" value="80" required>
					</td>
				</tr>
				<tr>
					<td>填表日期</td>
					<td>
						<input type="date" name="nowDate" value="2019-05-02" required/>
						<button id="chnDateBtn">Change</button>
					</td>
				</tr>
				<tr>
					<td>性別</td>
					<td>
						<select name="gender" required>
							<option value="male">男</option>
							<option value="female" selected>女</option>
						</select>
					</td>
				</tr>
				<tr>
					<td>興趣</td>
					<td>
						<label>
							<input type="checkbox" value="volleyball" name="interest" checked> 打排球 
						</label><br>
						<label>
							<input type="checkbox" value="high_jump" name="interest"> 跳高
						</label><br>
						<label>
							<input type="checkbox" value="javelin" name="interest"> 射標槍
						</label><br>
						<label>
							<input type="checkbox" value="piano" name="interest" checked> 彈鋼琴
						</label><br>
						<label>
							<input type="checkbox" value="reading" name="interest"> 雜誌
						</label><br>
						<label>
							<input type="checkbox" value="music" name="interest" checked> 聽音樂
						</label><br>
						<label>
					</td>
				</tr>
				<tr>
					<td>要訂購的比薩大小</td>
					<td>
						<label>
							<input type="radio" name="size" value="10">10吋
						</label><br>
						<label>
						    <input type="radio" name="size" value="12">12吋
						</label><br>
						<label>
						    <input type="radio" name="size" value="14" checked>14吋
						</label><br>
						<label>
						    <input type="radio" name="size" value="18">18吋
						</label><br>
						<label>
					</td>
				</tr>
				<tr>
					<td>大頭照</td>
					<td>
						<input type="file" name="photo">
						<div id="preview">
							
						</div>
					</td>
				</tr>
				<tr>
					<td>想說的話</td>
					<td>
						<textarea cols="50" rows="5" placeholder="輸入你想要寫的內容....">
							
						</textarea>
					</td>
				</tr>
				<tr>
					<td>查詢項目</td>
					<td>
						<input type="text" name="q" value="中壢資策會" id="query">
					</td>
				</tr>
				<tr>
					<td>動作 (HTML原生type="submit" or "reset")</td>
					<td>
						<!-- <input type="submit" name="send" value="submit">
						<input type="reset" name="resetToDefault" value="reset"> -->
					</td>
				</tr>
				<tr>
					<td>動作 2 (使用javascript送出表單)</td>
					<td>
						<button id="send">送出</button>
						<button id="resetToDefault">重設</button>
					</td>
				</tr>
			</table>	
		</form>
		<script type="text/javascript">

			// 學習重點：
			// Form表單物件
			// 將以下問題(*)完成

			function init(){
				// 抓取DOM元素
				var myForm = document.getElementById('myForm');
				var send = document.getElementById('send');
				var resetToDefault = document.getElementById('resetToDefault');
				var photo = document.getElementsByName('photo')[0];
				var chnDateBtn = document.getElementById('chnDateBtn');
				var nowDate = document.getElementsByName('nowDate')[0];

				// * 問題1. 表單送出
				send.addEventListener('click', function(e){
					// 注意: button在form表單裡，本身會帶有預設行為將其送出表單
          e.preventDefault();
					// 表單送出 提示：submit()
          let query = document.getElementById('query');
          query.value = '皮卡丘'
          myForm.submit();
				}, false);

				// * 問題2. 表單重設
				resetToDefault.addEventListener('click', function(e){
					// 注意: button在form表單裡，本身會帶有預設行為將其送出表單
          e.preventDefault(); // * 解決預設行為
					// 表單重設 提示：reset()
          myForm.reset();
				}, false);

				photo.addEventListener('change', function(e){
					var files = e.target.files; // 檔案的基本資訊，包括：檔案的名稱、大小與文件型態
					console.log(files[0])
					if(files && files[0]){
						var file = files[0];
						if(file.type.indexOf('image') > -1) {
							var reader = new FileReader(); // new a FileReader
							reader.onload = function (e) { // 註冊FileReader檔案讀取load的事件 (3)
								var img = document.createElement("img");
						    	img.setAttribute("src", e.target.result);
						    	img.style.height = '300px';
						    	var node = document.getElementById("preview"); // remove all children
								while (node.lastChild) {
								  node.removeChild(node.lastChild);
								}
						       	node.appendChild(img);
						    }
						    reader.readAsDataURL(file); // trigger onload event
						} else {
							alert('Please upload an image file. ');
						}
					}
				});

				// * 問題3. 取得現在的日期，並填入表單 格式：2020-09-23
				chnDateBtn.addEventListener('click', function(e){
					// 注意: button在form表單裡，本身會帶有預設行為將其送出表單
          e.preventDefault();
					// 取得現在時間
          let now  = new Date();
					// 填入時間 提示：DOM.value
          chnDateBtn.value = formatDate(now);
				});
			}

			// 時間格式的函式
			function formatDate(time){
				var year = time.getFullYear();
				var month = (time.getMonth()+1);
				var date = time.getDate();
				if(month < 10) month = '0' + month;
				if(date < 10) date = '0' + date;
				return year + '-' + month + '-' + date;
			}

			window.onload = init;

		</script>
	</body>
</html>