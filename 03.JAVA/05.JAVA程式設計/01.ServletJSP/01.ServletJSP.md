<h1>目錄</h1>

<ul>
<li><a href="#%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80%E7%9A%84%E4%B8%83%E5%A4%A7%E6%95%B4%E5%90%88%E6%87%89%E7%94%A8p438">程式語言的七大整合應用(p.438)</a></li>
<li><a href="#model-view-controller">Model-View-Controller</a></li>
<li><a href="#%E4%BB%8A%E6%97%A5%E8%AC%9B%E7%BE%A9%E9%A0%86%E5%BA%8F">今日講義順序</a></li>
<li><a href="#%E8%AA%B2%E7%A8%8B%E5%A4%A7%E7%B6%B1p03">課程大綱(p.03)</a></li>
<li><a href="#%E8%AA%B2%E7%A8%8B%E5%A4%A7%E7%B6%B1-p2">課程大綱 (p.2)</a></li>
<li><a href="#java-web-application-p1">Java Web Application (p.1)</a></li>
<li><a href="#servlet-%E9%96%8B%E7%99%BC%E7%92%B0%E5%A2%83-p285">Servlet 開發環境 (p.285)</a></li>
<li><a href="#%E5%AE%89%E8%A3%9D-tomcat-9-%E5%8F%8A%E7%B5%84%E6%85%8B%E6%AA%94%E8%A8%AD%E5%AE%9A-p290">安裝 Tomcat 9 及組態檔設定 (p.290)</a></li>
<li><a href="#servlet-%E7%9A%84%E7%94%9F%E5%91%BD%E9%80%B1%E6%9C%9F-p42">Servlet 的生命週期 (p.42)</a></li>
<li><a href="#java-servlet-jsp-%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88-p437">Java Servlet / JSP 解決方案 (p.437)</a></li>
<li><a href="#java-servlet-jsp-%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88-p10">Java Servlet / JSP 解決方案 (p.10)</a></li>
<li><a href="#connection-pool-%E9%80%A3%E7%B7%9A%E6%B1%A0-p134">Connection pool 連線池 (p.134)</a></li>
<li><a href="#transaction-%E7%AE%A1%E7%90%86%E4%B8%80-p131">Transaction 管理(一) (p.131)</a></li>
<li><a href="#%E8%B3%87%E6%96%99%E5%BA%AB%E9%80%A3%E7%B7%9A%E7%9A%84%E9%87%8D%E8%A4%87%E4%BD%BF%E7%94%A8-%E4%BA%8C-p130">資料庫連線的重複使用 (二) (p.130)</a></li>
<li><a href="#%E5%8F%96%E5%BE%97-server-%E8%B3%87%E8%A8%8A-p66">取得 Server 資訊 (p.66)</a></li>
<li><a href="#p83">(p.83)</a></li>
<li><a href="#p117">(p.117)</a></li>
<li><a href="#eclipse-ide-%E6%95%B4%E5%90%88%E9%96%8B%E7%99%BC%E7%92%B0%E5%A2%83-p341">Eclipse (IDE 整合開發環境) (p.341)</a></li>
<li><a href="#tomcat-9x-%E8%A8%AD%E5%AE%9Ap294">Tomcat 9.x 設定(p.294)</a></li>
<li><a href="#web-application-%E6%A6%82%E8%A7%80-%E4%B8%80-p6">Web Application 概觀 (一) (p.6)</a></li>
<li><a href="#web-application-%E6%A6%82%E8%A7%80-%E4%BA%8C-p7">Web Application 概觀 (二) (p.7)</a></li>
<li><a href="#http-%E5%9F%BA%E7%A4%8E-post-p18">Http 基礎 POST (p.18)</a></li>
<li><a href="#web-application-%E6%A6%82%E8%A7%80-%E4%B8%89-p8">Web Application 概觀 (三) (p.8)</a></li>
<li><a href="#java-servlet-jsp-%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88-%E4%B8%89-p10">Java Servlet / JSP 解決方案 (三) (p.10)</a></li>
<li><a href="#web-application-%E6%A6%82%E8%A7%80-%E5%9B%9B-p9">Web Application 概觀 (四) (p.9)</a></li>
<li><a href="#%E9%96%8B%E7%99%BC%E7%92%B0%E5%A2%83%E6%BA%96%E5%82%99-%E4%B8%80-p11">開發環境準備 (一) (p.11)</a></li>
<li><a href="#%E9%96%8B%E7%99%BC%E7%92%B0%E5%A2%83%E6%BA%96%E5%82%99-%E4%BA%8C-p12">開發環境準備 (二) (p.12)</a></li>
<li><a href="#27-%E5%AE%89%E8%A3%9D-tomcat-9-%E5%8F%8A-%E7%B5%84%E6%85%8B%E6%AA%94%E8%A8%AD%E5%AE%9A-p290">2/7 安裝 Tomcat 9 及 組態檔設定 (p.290)</a></li>
<li><a href="#tomcat-7x-8x-9x-%E7%B0%A1%E4%BB%8B-p291">Tomcat 7.x 8.x 9.x 簡介 (p.291)</a></li>
<li><a href="#servlet-3x-4x-%E8%88%87-tomcat-7x-8x-9x-p295">Servlet 3.x, 4.x 與 Tomcat 7.x 8.x, 9.x (p.295)</a></li>
<li><a href="#tomcat-9x-%E8%A8%AD%E5%AE%9A-p292~293">Tomcat 9.x 設定 (p.292~293)</a></li>
<li><a href="#eclipse-ide-%E6%95%B4%E5%90%88%E9%96%8B%E7%99%BC%E7%92%B0%E5%A2%83-p341-1">Eclipse (IDE 整合開發環境) (p.341)</a></li>
<li><a href="#eclipse-%E4%B9%8B-tomcat-embedded-p346~355">Eclipse 之 Tomcat Embedded (p.346~355)</a></li>
<li><a href="#servlet-%E7%AF%84%E4%BE%8B-war-%E6%AA%94%E5%8C%AF%E5%85%A5-p356~369">Servlet 範例 war 檔匯入 (p.356~369)</a></li>
<li><a href="#%E6%92%B0%E5%AF%AB%E8%88%87%E9%83%A8%E5%B1%AC-http-servlet-p32~41">撰寫與部屬 HTTP Servlet (p.32~41)</a></li>
<li><a href="#java-servlet-%E7%9A%84%E5%84%AA%E5%8B%A2-p13">Java Servlet 的優勢 (p.13)</a></li>
<li><a href="#%E5%8F%96%E5%BE%97-client-%E7%9A%84%E8%B3%87%E8%A8%8Ap76">取得 Client 的資訊(p.76)</a></li>
<li><a href="#%E5%AE%89%E5%85%A8%E6%80%A7security-p233">安全性(security) (p.233)</a></li>
<li><a href="#java-ee-p14">Java EE (p.14)</a></li>
<li><a href="#%E5%BB%BA%E7%AB%8B%E8%AA%B2%E7%A8%8B%E7%94%A8-sql">建立課程用 SQL</a></li>
<li><a href="#tomcat-9x-%E8%A8%AD%E5%AE%9A-p203">Tomcat 9.x 設定 (p.203)</a></li>
<li><a href="#%E9%9D%A2%E8%A9%A6%E5%95%8F%E9%A1%8C">面試問題</a></li>
</ul>

---

# 程式語言的七大整合應用(p.438)

|   JAVA 學習進程    | MVC 位置 |
| :----------------: | :------: |
|      Struts 2      |    VC    |
|     Spring MVC     |    VC    |
|     Spring ORM     |    M     |
|     Hibernate      |    M     |
|    Servlet/JSP     |   MVC    |
| JDBC<br>資料庫連結 |    M     |
|     基礎 Java      |          |

- Struts 2 與 Spring MVC 則一使用

# Model-View-Controller

- **M**odel 是 `*.java` (ORM)
- **V**iew 是 JSP
- **C**ontroller 是 `*.java` (Servlet)

- 簡易範例
  - C 導演
  - V 藝人
  - M 工作人員

# 今日講義順序

- p.438
- p.172
- p.10
- p.43
  - 先 Servlet (寫程式用 Servlet)
  - 在 JSP (寫網頁用 JSP)
- p.03

# 課程大綱(p.03)

- JavaServerPages (JSP)
- 運算式語言 EL (MVC 中的`View`)
- JSTL (MVC 中的`View`)

# 課程大綱 (p.2)

1. Web Application `開發環境準備` <sup>(p.285)</sup>
2. 撰寫與部屬 HTTP Servlet
3. Servlet 的生命週期(Servlet 介面) <sup>(記得複習執行續)</sup> <sup><bikao>★</bikao></sup>
4. 擷取資訊(HttpServlet**Request** <sup>(Request，p.25)</sup>,ServletConfig,ServletContext <sup>(大，p.66)</sup> 介面) <sup>(getXXX)</sup> <sup><bikao>★</bikao></sup>
5. 傳送 HTML 資訊(HttpServlet**Response** <sup>(Response，p.25)</sup> 介面) <sup>(setXXX)</sup> <sup><bikao>★</bikao></sup>
6. Session Tracking (HttpSession <sup>(中，p.117)</sup> 介面) <sup>(p.76)</sup>
7. 資料庫連結 <sup>(p.437)</sup>
8. Servlet 協同運作 (HttpServeletRequest <sup>(小，p.83)</sup> , RequestDispatcher 介面)

# Java Web Application (p.1)

1. Web Application

   - CGI (p.8)
   - ASP (p.9)
   - PHP (p.9)

1. Java Web Application
   - Servlet (學扎實什麼都能通)
   - JSP (學會只是會用而已)

# Servlet 開發環境 (p.285)

1. 安裝 JDK/JAVA
1. 安裝 Tomcat9 級組態檔設定
1. 程式開發工具
1. Eclipse 之 Tomcat Embedded
1. `Servlet 範例 war 檔匯入` (套件從 servlet 換成 jakata)
1. 新建動態 Web 專案
1. Eclipse 之基本輔助功能

# 安裝 Tomcat 9 及組態檔設定 (p.290)

# Servlet 的生命週期 (p.42)

1. Servlet 生命週期基本概念
2. `創建實體 (1/4)`
   1. Servlet Reloading (Servlet 重載入)
   2. Load on Startup (啟動時載入)
3. `初始化 (2/4)`
   1. Init Parameter (初始參數)
4. `服務 (3/4)`(要做鎖定，實體變數要鎖定)
   1. Persistence v.s. Synchronization
   2. Single ThreadModel (單續模型)(Deprecated)
5. `卸載 (4/4)`
   1. Initial & Destroy 協同運作
6. Background Thread (背景執行續)
7. Cache (快取)【參考 】

# Java Servlet / JSP 解決方案 (p.437)

- 為什麼需要用連線池
  - 提高 SQL 效能
  - 解決交易 Transaction 問題

# Java Servlet / JSP 解決方案 (p.10)

- 多執行續 (p.50-51)

# Connection pool 連線池 (p.134)

- wait()
- notify()

# Transaction 管理(一) (p.131)

- setAutoCommit()
- commit()
- rollback()

# 資料庫連線的重複使用 (二) (p.130)

- 使用 Transaction 時資料庫連線不能共用
  - 否則全部資料一起 commit、rollback

# 取得 Server 資訊 (p.66)

- ServletContext <sup>(大)</sup>

# (p.83)

- Request <sup>(小)</sup>

# (p.117)

- HttpSession <sup>(中)</sup>

# Eclipse (IDE 整合開發環境) (p.341)

# Tomcat 9.x 設定(p.294)

- 建立資料夾

  - `C:\EA102_WebApp`

  - 文件夾名稱需全英文

- 湯姆貓 9.0.35 安裝

  - 複製 `apache-tomcat-9.0.35` 到第一步資料夾

  - 文件位置: `C:\Users\USER\Desktop\SL314_Servlet4課程分享\SL314_第一次分享\01_Servlet_Container\●已設定完成的Tomcat-9.0.35 (含資料庫Driver) (●useBodyEncodingForURI)`

- 運行環境

  - 關閉 `shutdown.bat`

  - 開啟 `startup.bat`

- 開啟後帳密

  - manager-gui

# Web Application 概觀 (一) (p.6)

- 動態網頁: 讓網頁與伺服器互動

- 靜態網頁: 只讓使用者瀏覽該內容

- `Web Application`: 是一種在伺服器上執行的應用程式

- Request/Response 通訊模型: Request(請求)與 Response(回應)資料
  - Request: getXXX()
  - Response: setXXX()

# Web Application 概觀 (二) (p.7)

- Requst/Response 通訊模型

  - 用戶發送資源(Resource)索取的請求給伺服(Requst)端

  - 伺服器回應(Response)給用戶端

# Http 基礎 POST (p.18)

- 資料傳輸設置，與通訊協定

# Web Application 概觀 (三) (p.8)

- 共同閘道介面 (CGI) Common Gateway Interface

  - 是第一種用來產生`動態內容`的實用技術

  - 會讓每個請求(request)產生新`行程 (process，程序)`，將耗用相當可觀的伺服

- 衍生更快的做法 Fast CGI

# Java Servlet / JSP 解決方案 (三) (p.10)

- `在多執行續環境 server 會以為只有一支程式再跑`

- 可用的 Port:

  - 2^16 = 65535
    - 0~1023: 給全球通用的功能使用
    - 1024~65535: 其他，或私人用

- 一次可連線數: 65535-1024+1 = 64512
  - 如果使用多執行續，伺服器會將這麼多連線只當作一隻程式在運行，所以速度會很快

|                 | Port  |
| --------------- | ----- |
| HTTP            | 80    |
| Upload/Download | 20/21 |
| mailServer      | 25    |
| oracle          | 1521  |
| SQLServer       | 1433  |
| MySQL           | 3306  |

# Web Application 概觀 (四) (p.9)

- CGI 之外的解決方案

  - ASP

    - 只能搭配特定 Web Server
    - windows + IIS + ASP

  - PHP

    - linux + php + MySQL

  - JSP

    - 可以在數十種平台執行(Write Once, Run Anywhere)

- JSP 有 JavaBean 元件 <sup>(`包裝資料，重複使用`。p.167)</sup>

# 開發環境準備 (一) (p.11)

- 能執行 Servlet 的軟體稱之 Servlet runner 或 `Servlet Container (Web Container)` 或 Servlet engine

- 使用 Tomcat 原因: `新、小、免費、標準`

# 開發環境準備 (二) (p.12)

- Servlet Container 主要用來執行 Java Servlet

  - 獨立式 <sup>(上線)</sup>

    - 自身內建 Servlet 支援機制的伺服器
    - JDK 安裝步驟(p.286)
    - Tomcat 安裝步驟(p.290~295)

  - ~~附加式~~ <sup>(X)</sup> 沒有 webServer，只是幫人附加 Servlet Container

  - 可嵌入式 <sup>(開發)</sup>

# 2/7 安裝 Tomcat 9 及 組態檔設定 (p.290)

- http://www.apache.org 下載最新版的 Tomcat

# Tomcat 7.x 8.x 9.x 簡介 (p.291)

- Tomcat 7.0.x 開始支援 Servlet 3.0 <sup><bikao>★</bikao></sup>
- Tomcat 9.0.x 開始支援 Servlet 4.0 <sup><bikao>★</bikao></sup>

# Servlet 3.x, 4.x 與 Tomcat 7.x 8.x, 9.x (p.295)

- Servlet 3.x

  - <sup><bikao>★</bikao></sup> 支援 @annotation ，簡化 web.xml <sup>(部屬描述檔)</sup>
  - <sup><bikao>★</bikao></sup> 支援檔案上傳...等
  - 支援可插拔 web-片段
  - 支援非同步處裡

- Servlet 4.x

  - 有些介面採用預設方法，所以不用實作全部方法
  - HttpServerletRequest 的 newPushBuilder，用來建立 PushBuilder 以支援 HTTP/2 的 Server Push

# Tomcat 9.x 設定 (p.292~293)

- conf 組態(就是組態檔)

1. `port`: C:\EA102_WebApp\apache-tomcat-9.0.35\conf\ `server.xml`

   - 69 行，port `8080` 改 `8081`
   - 為了避開已被占用的 8080 port

```xml
<Connector port="8081" protocol="HTTP/1.1"
            connectionTimeout="20000"
            redirectPort="8443" useBodyEncodingForURI="true" />
```

2. `manager`: C:\EA102_WebApp\apache-tomcat-9.0.35\conf\ `tomcat-users.xml`

   - 熱部屬用

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<tomcat-users xmlns="http://tomcat.apache.org/xml"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://tomcat.apache.org/xml tomcat-users.xsd"
              version="1.0">
<!--
  NOTE:  By default, no user is included in the "manager-gui" role required
  to operate the "/manager/html" web application.  If you wish to use this app,
  you must define such a user - the username and password are arbitrary. It is
  strongly recommended that you do NOT use one of the users in the commented out
  section below since they are intended for use with the examples web
  application.
-->
<!--
  NOTE:  The sample user and role entries below are intended for use with the
  examples web application. They are wrapped in a comment and thus are ignored
  when reading this file. If you wish to configure these users for use with the
  examples web application, do not forget to remove the <!.. ..> that surrounds
  them. You will also need to set the passwords to something appropriate.
-->

  <role rolename="tomcat"/>
  <role rolename="role1"/>
  <role rolename="manager-gui"/>
  <role rolename="manager-script"/>
  <role rolename="admin-gui"/>

  <user username="tomcat" password="tomcat" roles="tomcat"/>
  <user username="both"   password="tomcat" roles="tomcat,role1"/>
  <user username="role1"  password="tomcat" roles="role1"/>

  <user username="manager-gui"    password="manager-gui"    roles="manager-gui"/>
  <user username="manager-script" password="manager-script" roles="manager-script"/>
  <user username="admin-gui"      password="admin-gui"      roles="admin-gui"/>

</tomcat-users>
```

3. `listings`: C:\EA102_WebApp\apache-tomcat-9.0.35\conf\ `web.xml`

   - 122 行 false 改成 true
   - 方便程式測試
   - 上線需還原成 false，否則會有安全上問題

```xml
<servlet>
    <servlet-name>default</servlet-name>
    <servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>
    <init-param>
        <param-name>debug</param-name>
        <param-value>0</param-value>
    </init-param>
    <init-param>
        <param-name>listings</param-name>
        <param-value>true</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>
```

4. `context.xml`: C:\EA102_WebApp\apache-tomcat-9.0.35\conf\ `context.xml`

   - Tomcat 6 開始有的新檔案
   - 與連線池相關

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!-- The contents of this file will be loaded for each web application -->
<Context antiResourceLocking="false" privileged="true"
                      reloadable="true" crossContext="true">

    <Resource name="jdbc/TestDB" auth="Container"
              type="javax.sql.DataSource" driverClassName="oracle.jdbc.driver.OracleDriver"
              url="jdbc:oracle:thin:@localhost:1521:XE"
              username="hr" password="123456" maxTotal="20" maxIdle="10"
              maxWaitMillis="-1"/>

    <!-- Default set of monitored resources. If one of these changes, the    -->
    <!-- web application will be reloaded.                                   -->
    <WatchedResource>WEB-INF/web.xml</WatchedResource>
    <WatchedResource>WEB-INF/tomcat-web.xml</WatchedResource>
    <WatchedResource>${catalina.base}/conf/web.xml</WatchedResource>

    <!-- Uncomment this to disable session persistence across Tomcat restarts -->
    <!--
    <Manager pathname="" />
    -->
</Context>
```

5. `console 亂碼`: C:\EA102_WebApp\apache-tomcat-9.0.35\conf\ `logging.properties`

   - tomcat 9.0.14 開始內建 UTF-8 設定，造成伺服器啟動時控制台出現亂碼
   - 註解掉 UTF-8 這行就好

```xml
# java.util.logging.ConsoleHandler.encoding = UTF-8
```

# Eclipse (IDE 整合開發環境) (p.341)

1. Eclipse 安裝 (可同時安裝不同版本 Eclipse)

```cs
檔案路徑: "C:\Users\USER\Desktop\SL314_Servlet4課程分享\SL314_第一次分享\11_小型程式\Rar\winrar-x64-520tc.exe"
```

2. 將檔案解壓縮至 `C:\EA102_WebApp`

```cs
檔案路徑: "C:\Users\USER\Desktop\SL314_Servlet4課程分享\SL314_第一次分享\02_Eclipse Resource\Eclipse Web Tools Platform 4.14 (Java EE all-in-one 的版本 )\eclipse-jee-2019-12-R-win32-x86_64.zip"
```

3. 創建資料夾 `C:\eclipse_WTP_workspace1`

# Eclipse 之 Tomcat Embedded (p.346~355)

1. Tomcat 9.x : 將 ojdbc6.jar 放入 lib 內

2. `Window` > `Preference` > `Server` > `Runtime Environments` > 選擇啟用的伺服器 `Apache Tomcate v9.0` > 勾選 `Create a new local server` > `Next` > 選擇貓的版本 `apache-tomcat-9.0.35` > JRE(`選擇 JDK 版本`)，同 `%JAVA_HOME%` 的 JDK 版本即可 > `Finish`

# Servlet 範例 war 檔匯入 (p.356~369)

1. `File` > `Import` > `Web` > `WAR file` > `Next`

2. `匯入 war` > `Finish`

```cs
檔案路徑: "C:\Users\USER\Desktop\SL314_Servlet4課程分享\SL314_第一次分享\03_Servlet_範例及資源_for_Eclipse_WTP\SL314.war"
```

- 要關閉 server 一定要在 server 的 tab 中按 `Stop to Server`

# 撰寫與部屬 HTTP Servlet (p.32~41)

- 頁面路徑設置，設定好後才能在 localhost 上開啟頁面

# Java Servlet 的優勢 (p.13)

- <sup><bikao>★</bikao></sup> 效率與耐用性

  - 只要 Servlet 被載入一次，其 `object instence` 即`永久保存於伺服器的記憶體中`

  - 由於是用物件形式存在，故能`自動維護自己的狀態`，並`持續保有外部資源`

- <sup><bikao>★</bikao></sup> 整合性

  - 利用伺服器來轉譯檔案路徑...

# 取得 Client 的資訊(p.76)

- <sup><bikao>★</bikao></sup> <sup><bikao>★</bikao></sup> <sup><bikao>★</bikao></sup> 全要背 <sup><bikao>★</bikao></sup> <sup><bikao>★</bikao></sup> <sup><bikao>★</bikao></sup>

  - 第 4 點、第 16 點一定要記住

# 安全性(security) (p.233)

- 安全防護(security)是編寫 Web 程式時必須考量的重點之一

- 目的與任務

  1.  驗證 Authentication
  2.  授權 Authentication
  3.  資料的保密性 Confidentiality or Data Privacy
  4.  資料的完整性 Data Integrity

# Java EE (p.14)

- Java EE 細項說明

# 建立課程用 SQL

- 此行可解決 Oracle 版本問題

```sql
alter session set deferred_segment_creation=false;
```

- 建立表格完整 SQL

```sql
                                          --建立表格: EMP2 和 DEPT2--
----------------------------------------------------------------------------------------------------------------------------
alter session set deferred_segment_creation=false;

DROP TABLE EMP2;
DROP TABLE DEPT2;
DROP SEQUENCE emp2_seq;
DROP SEQUENCE dept2_seq;


CREATE TABLE DEPT2 (
 DEPTNO             NUMBER(2) NOT NULL,
 DNAME              VARCHAR2(14),
 LOC                VARCHAR2(13),
 CONSTRAINT DEPT2_PRIMARY_KEY PRIMARY KEY (DEPTNO));

CREATE SEQUENCE dept2_seq
INCREMENT BY 10
START WITH 10
NOMAXVALUE
NOCYCLE
NOCACHE;

INSERT INTO DEPT2 VALUES (dept2_seq.NEXTVAL,'財務部','臺灣台北');
INSERT INTO DEPT2 VALUES (dept2_seq.NEXTVAL,'研發部','臺灣新竹');
INSERT INTO DEPT2 VALUES (dept2_seq.NEXTVAL,'業務部','美國紐約');
INSERT INTO DEPT2 VALUES (dept2_seq.NEXTVAL,'生管部','中國上海');



CREATE TABLE EMP2 (
 EMPNO               NUMBER(4) NOT NULL,
 ENAME               VARCHAR2(10),
 JOB                 VARCHAR2(9),
 HIREDATE            DATE,
 SAL                 NUMBER(7,2),
 COMM                NUMBER(7,2),
 DEPTNO              NUMBER(2) NOT NULL,
 CONSTRAINT EMP2_DEPTNO_FK FOREIGN KEY (DEPTNO) REFERENCES DEPT2 (DEPTNO),
 CONSTRAINT EMP2_EMPNO_PK PRIMARY KEY (EMPNO));

CREATE SEQUENCE emp2_seq
INCREMENT BY 1
START WITH 7001
NOMAXVALUE
NOCYCLE
NOCACHE;

INSERT INTO EMP2 VALUES (emp2_seq.NEXTVAL , 'KING'   , 'PRESIDENT', TO_DATE('1981-11-17','YYYY-MM-DD') , 5000.5 , 0.0  ,10);
INSERT INTO EMP2 VALUES (emp2_seq.NEXTVAL , 'BLAKE'  , 'MANAGER'  , TO_DATE('1981-05-01','YYYY-MM-DD') , 2850   , 0.0  ,30);
INSERT INTO EMP2 VALUES (emp2_seq.NEXTVAL , 'CLARK'  , 'MANAGER'  , TO_DATE('1981-01-09','YYYY-MM-DD') , 2450   , 0.0  ,10);
INSERT INTO EMP2 VALUES (emp2_seq.NEXTVAL , 'JONES'  , 'MANAGER'  , TO_DATE('1981-04-02','YYYY-MM-DD') , 2975   , 0.0  ,20);
INSERT INTO EMP2 VALUES (emp2_seq.NEXTVAL , 'MARTIN' , 'SALESMAN' , TO_DATE('1981-09-28','YYYY-MM-DD') , 1250   , 1400 ,30);
INSERT INTO EMP2 VALUES (emp2_seq.NEXTVAL , 'ALLEN'  , 'SALESMAN' , TO_DATE('1981-02-02','YYYY-MM-DD') , 1600   , 300  ,30);
INSERT INTO EMP2 VALUES (emp2_seq.NEXTVAL , 'TURNER' , 'SALESMAN' , TO_DATE('1981-09-28','YYYY-MM-DD') , 1500   , 0.0  ,30);
INSERT INTO EMP2 VALUES (emp2_seq.NEXTVAL , 'JAMES'  , 'CLERK'    , TO_DATE('1981-12-03','YYYY-MM-DD') , 950    , 0.0  ,30);
INSERT INTO EMP2 VALUES (emp2_seq.NEXTVAL , 'WARD'   , 'SALESMAN' , TO_DATE('1981-02-22','YYYY-MM-DD') , 1250   , 500  ,30);
INSERT INTO EMP2 VALUES (emp2_seq.NEXTVAL , 'FORD'   , 'ANALYST'  , TO_DATE('1981-12-03','YYYY-MM-DD') , 3000   , 0.0  ,20);
INSERT INTO EMP2 VALUES (emp2_seq.NEXTVAL , 'SMITH'  , 'CLERK'    , TO_DATE('1980-12-17','YYYY-MM-DD') , 800    , 0.0  ,20);
INSERT INTO EMP2 VALUES (emp2_seq.NEXTVAL , 'SCOTT'  , 'ANALYST'  , TO_DATE('1981-12-09','YYYY-MM-DD') , 3000   , 0.0  ,20);
INSERT INTO EMP2 VALUES (emp2_seq.NEXTVAL , 'ADAMS'  , 'CLERK'    , TO_DATE('1983-01-12','YYYY-MM-DD') , 1100   , 0.0  ,20);
INSERT INTO EMP2 VALUES (emp2_seq.NEXTVAL , 'MILLER' , 'CLERK'    , TO_DATE('1982-01-23','YYYY-MM-DD') , 1300   , 0.0  ,10);

commit;
----------------------------------------------------------------------------------------------------------------------------
```

# Tomcat 9.x 設定 (p.203)

- 修改資料庫連線，則 eclipse 與 tomcat 中的 `context.xml` 都要修改

  - 設定好後可以依照課程環境執行:

    http://localhost:8081/IBM_9/select_page_Basic.jsp
    就能看見表資料。

# 面試問題

- JDBC 有哪 4 行 code

- Servlet 有幾個生命週期

  - 創建實體
  - 初始化
  - 服務
  - 卸載

- JAVA 口角

  - 萬般皆物件
  - 要什麼給什麼

- I/O 流用法

- 為什麼需要用連線池(p.437)
  - 提高 SQL 效能
  - 解決交易 Transaction 問題
