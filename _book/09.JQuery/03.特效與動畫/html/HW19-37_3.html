<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>HW19-37</title>
    <style>
      td {
        width: 50px;
        height: 50px;
      }
    </style>
  </head>
  <body>
    <form>
      <select id="yy">
        <option value="2015">2015</option>
        <option value="2016">2016</option>
        <option value="2017">2017</option>
        <option value="2018">2018</option>
        <option value="2019">2019</option>
        <option value="2020">2020</option>
      </select>
      <select id="mm">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
      </select>
    </form>
    <table border="1" bordercolor="blue" align="center">
      <tr>
        <td>日</td>
        <td>一</td>
        <td>二</td>
        <td>三</td>
        <td>四</td>
        <td>五</td>
        <td>六</td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
    </table>

    <script type="text/javascript">
      //選單可以選擇年份跟月份 ---選單可以越滾顯示越多年份
      var yy = document.getElementById('yy');
      var mm = document.getElementById('mm');
      yy.addEventListener('change', change);
      mm.addEventListener('change', change);
      var year = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
      var b = document.getElementsByTagName('td'); // 因為這個經常會修改所以可以在這裡寫上

      function change() {
        if (yy.value % 100 !== 0 && yy.value % 4 === 0) {
          year[1] = 29;
        } else if (yy.value % 400 === 0) {
          year[1] = 29;
        } else {
          year[1] = 28;
        }

        var now = new Date();
        now.setFullYear(yy.value);
        now.setMonth(mm.value - 1);
        now.setDate(1);
        var day = now.getDay();

        // b.length 即表示直接取table中td的數量
        for (j = 7; j < b.length; j++) {
          b[j].innerText = ''; // 因為table已經有了，所以直接用 innerText 修改欄位內的文字就好
        }

        // 日曆的日期顯示，因為日期可能會超過當前表格的 td 數量，所以需要判斷超過的情形
        var calendar;
        if (year[mm.value - 1] + 7 + day > b.length) {
          calendar = b.length;
        } else {
          calendar = year[mm.value - 1] + 7 + day;
        }

        for (i = 7 + day; i < calendar; i++) {
          b[i].innerText = i - (6 + day); // 修改原因 121 行
        }
      }
    </script>
  </body>
</html>
