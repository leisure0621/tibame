# SELECT

- 欄位別名

  - `欄位 新名稱` 或 `欄位 AS 新名稱`

```sql
-- SELECT
SELECT ISBN, BOOK_NAME NAME, PRICE * 0.9 AS SALE_PRICE
FROM BOOK;
```

- 表格內指定值，並設定指定名稱(還能計算)

```sql
-- SELECT
SELECT ISBN, BOOK_NAME NAME, PRICE * 0.9 AS SALE_PRICE, AUTHOR, PUBLICATION_DATE
FROM BOOK;
```

- 表格內所有資料

```sql
SELECT * FROM BOOK;
```

- 查詢後結果依照 BOOK_NAME 進行降序

  - `欄位 DESC` (大 → 小，降冪) 或 `欄位 ASC` (小 → 大，升冪)

```sql
-- ORDER BY兩個以上欄位，可分別指定升冪或降冪
SELECT * FROM BOOK ORDER BY PRICE ASC, BOOK_NAME DESC;
```

- 依照空值排序

  - `欄位 NULLS FIRST` (排在前) 或 `欄位 NULLS LAST` (排在後)

```sql
-- 先將任一price改為null，NULLS FIRST會將null值排在前
SELECT * FROM BOOK ORDER BY PRICE NULLS FIRST;
```

# SELECT 練習

- 將 CUSTOMER 表格的 CUSTOMER_NAME (別名為 NAME), PHONE, ADDRESS 欄位資料列出

```sql
select customer_name NAME,phone,address from customer;
```

- 將 CUSTOMER 表格的所有欄位資料列出

```sql
select * from customer;
```

# WHERE

- 判斷`文字`

```sql
-- 查詢出版社名稱為Pearson的資料
SELECT * FROM PUBLISHER
WHERE PUBLISHER_NAME = 'Pearson';
```

- 判斷`範圍`

```sql
-- 查詢書價在1000元以內的書籍
SELECT * FROM BOOK
WHERE PRICE < 1000;
```

- 判斷`空值`

```sql
-- 將沒有出版社資訊的書籍列出 (先將一本書的PUBLISHER_ID值清空)
SELECT * FROM BOOK
WHERE PUBLISHER_ID IS NULL;
```

- 搜尋時`指定開頭`並`模糊查詢`

  - `LIKE '_搜尋值%'`

```sql
-- 查詢書名開頭為任一字元再加上「ava」的資料
SELECT * FROM BOOK
WHERE BOOK_NAME LIKE '_ava%';
```

- 搜尋`所有`

```sql
-- 查詢書名開頭為任一字元再加上「ava」的資料
SELECT * FROM BOOK
WHERE BOOK_NAME LIKE '%%';
```

- 搜尋時資料`轉大寫`

  - `upper("欄位")` 欄位轉大寫

  - `upper('%搜尋值%')` 搜尋的值轉大寫

```sql
-- 查詢書名含有「Java」的資料 (不區別大小寫)
SELECT * FROM BOOK
WHERE upper(BOOK_NAME) LIKE '%JAVA%';
```

- 搜尋時`不分大小寫`

```sql
-- 查詢書名含有「Java」的資料 (不區別大小寫)
SELECT * FROM BOOK
WHERE upper(BOOK_NAME) LIKE upper('%JAVA%');
```

# WHERE 練習

- 查詢客戶 ID 為 C001 的資料

```sql
select *
from customer
where customer_id = 'C001';
```

- 查詢出版日期為 2016/01/01 以後的書籍(方法 1)

```sql
-- 設訂當下統一日期格式
ALTER SESSION SET NLS_DATE_FORMAT = 'yyyy-mm-dd';
-- 搜尋
select *
from book
where PUBLICATION_DATE >'2016-01-01';
```

- 查詢出版日期為 2016/01/01 以後的書籍(方法 2)

```sql
select *
from book
where to_char(PUBLICATION_DATE,'yyyy-mm-dd') > '2016-01-01';
```

- 查詢出版日期為 2016/01/01 以後的書籍(方法 3)`常用`

```sql
select *
from book
where PUBLICATION_DATE > to_date('2016-01-01','yyyy-mm-dd');
```

- 查詢居住在 Taipei 的客戶

```sql
select *
from customer
where upper(address) like upper('%Taipei%');
```

# AND|OR|NOT|BETWEEN

- `AND`

```sql
-- AND: 查詢書名有「Java」且書價在1000元以內的資料 (不區別大小寫)，而且依照書價升冪排序
SELECT * FROM BOOK
WHERE upper(BOOK_NAME) LIKE '%JAVA%' AND PRICE < 1000
ORDER BY PRICE;
```

- `OR`

```sql
-- OR: 查詢書名有「Java」或是「Oracle」的資料
SELECT * FROM BOOK
WHERE upper(BOOK_NAME) LIKE '%JAVA%' OR upper(BOOK_NAME) LIKE '%ORACLE%';
```

- `NOT`

```sql
-- NOT: 查詢書價沒有大於1000元的書
SELECT * FROM BOOK
WHERE NOT PRICE > 1000;
```

- `BETWEEN`

```sql
-- BETWEEN: 查詢書價介於550(含)~935(含)元的書籍
SELECT * FROM BOOK
WHERE PRICE BETWEEN 550 AND 935;
```

# AND|OR|NOT|BETWEEN 練習

- 查詢出版日期介於 2016/01/01~2016/12/31 之間的書籍,而且依照書價降冪排序

```sql
select *
from book
where PUBLICATION_DATE between
      to_date('2016-01-01','yyyy-mm-dd') and
      to_date('2016-12-31','yyyy-mm-dd')
Order by price desc;
```

- 查詢居住在 Taipei 或 Taoyuan 的客戶

```sql
select *
from customer
where upper(address) like upper('%Taipei%') or
      upper(address) like upper('%Taoyuan%');
```

# IN|ANY|ALL

- `IN`

  - 搜尋的資料轉大寫

  - `不可`搭配運算符(`>`、`=`、`<` ...)使用

```sql
-- IN: 查詢出版社聯絡人為'PAUL'或'MARY'或'OCEAN'的資料 (不區別大小寫)
SELECT * FROM PUBLISHER
WHERE upper(CONTACT) IN ('PAUL', 'MARY', 'OCEAN');
```

- `IN`

  - 不區分大小寫: 搜尋的資料轉大寫且多重搜尋的值也轉

```sql
-- IN: 查詢出版社聯絡人為'PAUL'或'MARY'或'OCEAN'的資料 (不區別大小寫)
SELECT * FROM PUBLISHER
WHERE upper(CONTACT) IN (upper('paul'), upper('mary'), upper('ocean'));
```

- `NOT`

  - `NOT 欄位 IN (搜尋值,...)`

```sql
-- 查詢出版社聯絡人不為'PAUL'或'MARY'或'OCEAN'的資料 (不區別大小寫)
SELECT * FROM PUBLISHER
WHERE NOT upper(CONTACT) IN ('PAUL', 'MARY', 'OCEAN');
```

- `NOT`

  - `欄位 NOT IN (搜尋值,...)`

```sql
-- 查詢出版社聯絡人不為'PAUL'或'MARY'或'OCEAN'的資料 (不區別大小寫)
SELECT * FROM PUBLISHER
WHERE upper(CONTACT) NOT IN ('PAUL', 'MARY', 'OCEAN');
```

- `ANY`

  - ANY 可視為 `A or B or C ...`

  - `可`搭配運算符(`>`、`=`、`<` ...)使用

  - ANY 比 IN 更常用

```cs
ANY 比 IN 來得彈性，搭配不同運算符號會有不同功能
```

- `ANY` 配 `=`

```sql
-- ANY搭配「=」相當於IN
SELECT * FROM PUBLISHER
WHERE upper(CONTACT) = ANY ('PAUL', 'MARY', 'OCEAN');
```

- `ANY` 配 `NOT`

```sql
-- 加上NOT變成相反的條件
SELECT * FROM PUBLISHER
WHERE NOT upper(CONTACT) = ANY ('PAUL', 'MARY', 'OCEAN');
```

- `ANY` 配 `>`

```sql
-- 查詢書價大於500或1000的資料
SELECT * FROM BOOK
WHERE PRICE > ANY (500, 1000);
```

- `ALL`

  - ALL 可視為 `A and B and C ...`

```sql
-- 查詢書價既大於500，也大於1000的資料
SELECT * FROM BOOK
WHERE PRICE > ALL (500, 1000);
```

# SUM|AVG|COUNT|MAX|MIN 聚集函式

- `SUM` 計算加總

  - 如果 SUM(ISBN) 且 ISBN 中的`文字`為`純數字`，Oracle 也會自動轉成數字並加總

```sql
-- Aggregate Functions
-- 加總書名有Java的書價
SELECT SUM(PRICE) AS BOOKS_SUM FROM BOOK
WHERE upper(BOOK_NAME) LIKE '%JAVA%';
```

- `AVG` 計算平均

```sql
-- 計算平均書價
SELECT AVG(PRICE) AS BOOKS_AVERAGE
FROM BOOK;
```

- `COUNT` 資料筆數

```sql
-- 計算書價在1000元以上的總數量
SELECT COUNT(ISBN) FROM BOOK
WHERE PRICE >= 1000;
```

- `COUNT`

  - 若設定 `SELECT COUNT(1)` 則顯示的還是資料筆數

```sql
-- 計算書價在1000元以上的總數量
SELECT COUNT(1) FROM BOOK
WHERE PRICE >= 1000;
```

- `MAX`

```sql
-- 取得最高書與最低書價
SELECT MAX(PRICE) AS BOOK_MAX_PRICE, MIN(PRICE) AS BOOK_MIN_PRICE
FROM BOOK;
```

- 聚集函式也`可以一起用`

```sql
-- 取得最高書與最低書價
SELECT SUM(PRICE), MAX(PRICE) AS BOOK_MAX_PRICE, MIN(PRICE) AS BOOK_MIN_PRICE
FROM BOOK;
```

# 聚集函式練習

- 統計居住在台北的客戶總數量

```sql
-- 統計居住在台北的客戶總數量
select count(customer_id) 客戶總數量
from customer
where upper(address) like upper('%Taipei%');
```

- 統計訂單 1、2 的訂購總量

```sql
-- 統計訂單1、2的訂購總量
select count(quantity) 訂單筆數, sum(quantity) 訂購總量
from order_detail
where order_id in (1,2);
```

- 統計 2016 年的平均書價

```sql
-- 統計2016年的平均書價
select avg(price) 平均書價
from book
where PUBLICATION_DATE BETWEEN
    to_date('2016-01-01','yyyy-mm-dd') and
    to_date('2016-12-31','yyyy-mm-dd');
```
